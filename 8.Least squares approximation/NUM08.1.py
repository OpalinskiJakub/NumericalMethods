import numpy as np
import matplotlib.pyplot as plt


x = [0.0 ,
0.1 ,
0.2 ,
0.3 ,
0.4 ,
0.5 ,
0.6 ,
0.7000000000000001 ,
0.8 ,
0.8999999999999999 ,
1.0 ,
1.1 ,
1.2 ,
1.3 ,
1.4000000000000001 ,
1.5 ,
1.6 ,
1.7000000000000002 ,
1.7999999999999998 ,
1.9 ,
2.0 ,
2.1 ,
2.2 ,
2.3000000000000003 ,
2.4 ,
2.5 ,
2.6 ,
2.7 ,
2.8000000000000003 ,
2.9 ,
3.0 ,
3.1 ,
3.2 ,
3.3000000000000003 ,
3.4000000000000004 ,
3.5 ,
3.5999999999999996 ,
3.7 ,
3.8 ,
3.9000000000000004 ,
4.0 ,
4.1 ,
4.2 ,
4.3 ,
4.4 ,
4.5 ,
4.6000000000000005 ,
4.699999999999999 ,
4.8 ,
4.9 ,
5.0 ,
5.1 ,
5.2 ,
5.300000000000001 ,
5.4 ,
5.5 ,
5.6000000000000005 ,
5.699999999999999 ,
5.8 ,
5.8999999999999995 ,
6.0 ,
6.1 ,
6.2 ,
6.3 ,
6.4 ,
6.5 ,
6.6000000000000005 ,
6.7 ,
6.800000000000001 ,
6.8999999999999995 ,
7.0 ,
7.1 ,
7.199999999999999 ,
7.3 ,
7.4 ,
7.5 ,
7.6 ,
7.7 ,
7.800000000000001 ,
7.9 ,
8.0 ,
8.100000000000001 ,
8.2 ,
8.299999999999999 ,
8.4 ,
8.5 ,
8.6 ,
8.7 ,
8.8 ,
8.9 ,
9.0 ,
9.1 ,
9.200000000000001 ,
9.3 ,
9.399999999999999 ,
9.5 ,
9.6 ,
9.7 ,
9.8 ,
9.9 
]
x = np.array(x,np.double)
y = [
     4.950857293316135
, 5.244053198209668
, 4.596674286942168
, 3.7716580716201475
, 2.820357317867815
, 2.435183979838935
, 1.8427154815032336
, 1.884873778791347
, 1.6701780852316952
, 2.02009025604872
, 2.35297905622277
, 2.9519108172987774
, 2.811384490714026
, 2.1923411916713422
, 1.4726624983673788
, 0.47188633589198287
, -0.5964550145251905
, -1.6062181356763885
, -1.9439540531664607
, -2.243543594602372
, -1.8146936672294576
, -1.0014836426299722
, -0.021488901687543208
, 1.2105574572261142
, 1.950096486221235
, 2.147726797749521
, 2.386058662477445
, 1.6276162791842477
, 0.878177935162853
, 0.15487873029818516
, -0.8836175389013335
, -1.3503513494206691
, -1.6101784642728796
, -1.4787001634252899
, -0.7233564374853672
, -0.30649764371452737
, 0.5813795214195606
, 1.3277548470564633
, 1.3779696829338035
, 1.3551939546567966
, 1.0778359406497402
, 0.33578335517429647
, -0.4360195036632405
, -0.39089846501505077
, -0.6676220980455427
, -0.372342758930422
, 0.22940214179542823
, 1.0983021528588681
, 1.644487611305807
, 2.1907589841288946
, 1.6891965236969493
, 1.60113332214255
, 0.727392490365532
, -0.3784469516039776
, -1.5194065736091198
, -2.461367159423399
, -3.319439512465359
, -3.1158031727745517
, -2.9669094120167947
, -2.0396154092693064
, -0.7090451960771162
, 0.423624309572071
, 1.2237011126020463
, 1.9012489444004106
, 1.9946483370814991
, 1.5370581306443751
, 1.3367364724664577
, 0.37741996859478927
, 0.42875772071635154
, 0.042922627995487315
, 0.38433764726699404
, 0.20754827250754887
, 0.8993379565326189
, 1.1593794427280935
, 1.806518640860301
, 1.5108469914597054
, 1.244060783837899
, 0.10075484407763019
, -0.5106703931939942
, -1.6786552710352431
, -2.2764172123815034
, -2.7078888363733116
, -2.712611095545519
, -2.2149557354912313
, -1.195947900086233
, -0.19503930885823384
, 0.9671870968820517
, 1.6180804934508957
, 2.1651961611944537
, 1.9666093282881838
, 1.6088468151934212
, 0.4128648108476284
, -0.4694242316948962
, -1.1291006093954865
, -1.6264570455602219
, -1.6861064555939174
, -1.485834891615672
,-0.8679834875973519
, -0.33371755412078713
, 0.6473549716706635
]
y = np.array(y)
def solutiona(y,x):
    

    A = np.transpose(np.vstack([np.sin(2*x), np.sin(3*x),np.cos(5*x),np.exp((-1)*x)]))

    y = np.transpose(y)

    firstPart=np.dot(np.transpose(A),A)
    secondPart=np.dot(np.transpose(A),y)
    res=np.linalg.solve(firstPart,secondPart)
    print(res)

    yResult=[]
    for i in x:
        yResult.append(res[0]*np.sin(2*i) + res[1]*np.sin(3*i) + res[2]*np.cos(5*i) + res[3]*np.exp((-1)*i))

    plt.plot(x, y, "o",markersize=5)
    plt.plot(x, yResult,'red')
    plt.xlabel('x')
    plt.ylabel('y')
    plt.show()


solutiona(y,x)


